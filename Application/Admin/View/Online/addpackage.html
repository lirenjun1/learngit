<include file="Public:header"/>
<!--主页面-->
<div id="main-content" class="content">
    <ul class="breadcrumb">
        <li><a href="/">首页</a></li>
        <li class="active"><a href="">套餐</a></li>
        <li class="active">添加套餐</li>
    </ul>

    <div class="content-box-content">
        <form action="{:U('Online/packageadd')}" method="post" id="form" class="form-horizontal" role="form">
            <div class="form-group">
                <label for="account" class="col-sm-3 control-label">用　户ID：</label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" value="{$name['0']['id']}" id="b_id" name="b_id" style="display:none;">
                    <p style="margin:8px 0px 0px 0px;">{$name['0']['id']}</p>
                </div>
            </div>
            <div class="form-group">
                <label for="account" class="col-sm-3 control-label">用户昵称：</label>
                <div class="col-sm-9">
                    <p style="margin:8px 0px 0px 0px;">{$name['0']['b_name']}</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">套餐类型：</label>
                <div class="col-sm-9">
                    <select name="type" id="grade" class="form-control input-sm">
                        <option value="0">--选择套餐类型--</option>
                        <option value="4">1张图</option>
                        <option value="1">4张图</option>
                        <option value="2">6张图</option>
                        <option value="3">12张图</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">到期时间：</label>
                <div class="col-sm-9">
                    <input type="text" style="padding:5px 10px;width:40%;height:30px;border:1px solid #ccc;" class="" id="bid_start_time" readonly="true" value="">
                </div>
            </div>
        </form>
		<div class="form-group">
			<div class="col-sm-offset-3 col-sm-9">
			  <button type="submit" id="submit" class="btn btn-default btn-primary">确定</button>
              <a href="javascript:history.go(-1);" class="btn btn-default btn-primary">返回</a>
            </div>
		</div>
    </div>
</div
<include file="Public:footer"/>
<script src="__WEBPUBLIC__/Home/js/jquery-1.10.2.min.js"></script>
<link href="__PUBLIC__/Common/datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
<script src="__PUBLIC__/Common/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="__PUBLIC__/Common/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>

<script>	
	$(function(){
        $("#bid_start_time").datetimepicker({
            language:"zh-CN",
            format: "yyyy-mm-dd hh:ii",
            autoclose: true,
            todayBtn: true,
            startDate: "{$now}",
            minuteStep: 5,
            showMeridian: true,
        });
		$('#submit').click(function(){
            if($("#grade").val() == 0){
                alert('请选择套餐类型');
                return false;
            }
            if(_getTime($('#bid_start_time').val()) == 0){
                alert('请选择到期时间');
                return false;
            }
            $.ajax({
                type: 'post',
                url: "{:U('Online/packageadd')}",
                data:{
                    'id':$('#b_id').val(),
                    'type':$("#grade").val(),
                    'duetime':_getTime($('#bid_start_time').val()),
                },
                dataType: 'json',
                success: function (data) {
                    if (data.success) {
                        alert(data.success);
                        var b_id = data.b_id;
                        var url = "{:U('Online/package')}/b_id/"+b_id;
                        window.location.href = url;
                    }else {
                        alert(data.error);
                    }
                },
            })
            // $("#form").submit();
        });

	})
    function _getTime(str){
        var date = new Date(str);
        var t = date.getTime()/1000;
        if(isNaN(t))return '';
        else return t;
    }
</script>	
